<!DOCTYPE html>
<html>
  <head>
    <title>Messages</title>
    <link rel="stylesheet" href="/stylesheets/style.css" />
  </head>
  <body>
    <h1><%= messages.length %> Messages</h1>

    <ul>
      <% messages.forEach(function(message){ %>
        <li>
          <%= message.created_by %>: <%= message.data.message %>
          <br/>
          <!-- <%= JSON.stringify(message) %> -->

          <br/>

         <!-- TODO: Make this prettier -->
         
           likeCount: <%= message.like_count %>
           iLikeThis: <%= iLikeThis %>
         

         <!-- likebutton，post 消息 -->
          <form action="/chat/<%=message.id%>/like" method="post">  
            <input type="hidden" id="like" name="like" value="<%=!iLikeThis%>">
            <button type="submit">Like</button>
          </form>

        </li>
      <% }) %>
    </ul>

    <% if (signedInAs) { %>
      <div>Hi <%= signedInAs %>, leave a message:</div>

      <form action="/chat/create-message" method="post">
        <div>
          <label for="message">Message:</label>
          <textarea type="text" id="message" name="message" required cols="40" rows="2"></textarea>
        </div>
        <button type="submit">Create</button>
      </form>
    <% } %>

    <%- include('./includes/page-footer.ejs') %>

  </body>
</html>
